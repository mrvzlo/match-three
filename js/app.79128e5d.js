(function(e){function t(t){for(var r,o,u=t[0],s=t[1],c=t[2],h=0,f=[];h<u.length;h++)o=u[h],Object.prototype.hasOwnProperty.call(i,o)&&i[o]&&f.push(i[o][0]),i[o]=0;for(r in s)Object.prototype.hasOwnProperty.call(s,r)&&(e[r]=s[r]);l&&l(t);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],r=!0,u=1;u<n.length;u++){var s=n[u];0!==i[s]&&(r=!1)}r&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var r={},i={app:0},a=[];function o(t){if(r[t])return r[t].exports;var n=r[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=r,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)o.d(n,r,function(t){return e[t]}.bind(null,r));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/match-three/";var u=window["webpackJsonp"]=window["webpackJsonp"]||[],s=u.push.bind(u);u.push=t,u=u.slice();for(var c=0;c<u.length;c++)t(u[c]);var l=s;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0755":function(e,t,n){},"4ed4":function(e,t,n){"use strict";n("0755")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var r=n("7a23");function i(e,t,n,i,a,o){var u=Object(r["j"])("game");return Object(r["g"])(),Object(r["c"])(u)}var a=n("bee2"),o=n("d4ec"),u=n("262e"),s=n("2caf"),c=n("9ab4"),l=n("ce1f");function h(e,t,n,i,a,o){return Object(r["g"])(),Object(r["d"])(r["a"],null,[Object(r["e"])("canvas",{id:"back",style:Object(r["f"])({width:e.width+"px",height:e.height+"px"})},null,4),Object(r["e"])("canvas",{id:"gems",style:Object(r["f"])({width:e.width+"px",height:e.height+"px"})},null,4)],64)}var f,d,g=n("1da1"),v=(n("96cf"),n("cb29"),n("d81d"),n("d3b7"),n("159b"),n("3ca3"),n("ddb0"),n("4de4"),8),m=1e3,w=10,y=10,p=(1e3-2*w)/v,b=p-2*y,x=30,k=1e3/x;(function(e){e[e["Left"]=0]="Left",e[e["Top"]=1]="Top",e[e["Right"]=2]="Right",e[e["Bottom"]=3]="Bottom"})(f||(f={})),function(e){e[e["Clear"]=0]="Clear",e[e["Red"]=1]="Red",e[e["Green"]=2]="Green",e[e["Blue"]=3]="Blue",e[e["Yellow"]=4]="Yellow",e[e["Purple"]=5]="Purple"}(d||(d={}));var j=function(){function e(t,n){Object(o["a"])(this,e),this._x=t,this._y=n,this.round()}return Object(a["a"])(e,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"round",value:function(){this._x=Math.round(this.x),this._y=Math.round(this.y)}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;switch(e){case f.Left:return void(this._x-=t);case f.Right:return void(this._x+=t);case f.Top:return void(this._y-=t);case f.Bottom:return void(this._y+=t)}}},{key:"setY",value:function(e){this._y=e}}]),e}(),O=function(){function e(){Object(o["a"])(this,e)}return Object(a["a"])(e,[{key:"drawRed",value:function(e,t){var n=[new j(4,5),new j(b-4,5),new j(b/2,b)];t.fillStyle="#a55",this.drawPolygon(e,n,t)}},{key:"drawGreen",value:function(e,t){var n=b/4,r=[new j(n,0),new j(b-n,0),new j(b,n),new j(b,b-n),new j(b-n,b),new j(n,b),new j(0,b-n),new j(0,n)];t.fillStyle="#485",this.drawPolygon(e,r,t)}},{key:"drawBlue",value:function(e,t){var n=b/5,r=[new j(b/2,0),new j(b-10,n),new j(b-10,b-n),new j(b/2,b),new j(10,b-n),new j(10,n)];t.fillStyle="#35a",this.drawPolygon(e,r,t)}},{key:"drawPurple",value:function(e,t){var n=b/5,r=[new j(b/2,0),new j(b-5,n+b/7),new j(b-n,b-3),new j(n,b-3),new j(5,n+b/7)];t.fillStyle="#6e3b7a",this.drawPolygon(e,r,t)}},{key:"drawYellow",value:function(e,t){var n=[new j(b/2,0),new j(b,b/2),new j(b/2,b),new j(0,b/2)];t.fillStyle="#ec7",this.drawPolygon(e,n,t)}},{key:"drawPolygon",value:function(e,t,n){this.fillPolygon(e,t,n),n.lineWidth=3,n.strokeStyle="#333",n.stroke()}},{key:"fillPolygon",value:function(e,t,n){n.beginPath();var r=this.applyBasePoint(e,t),i=r.shift();n.moveTo(i.x,i.y),r.forEach((function(e){return n.lineTo(e.x,e.y)})),n.lineTo(i.x,i.y),n.fill()}},{key:"applyBasePoint",value:function(e,t){return t.map((function(t){return new j(t.x+e.x,t.y+e.y)}))}}]),e}(),P=function(){function e(){Object(o["a"])(this,e);var t=document.getElementById("gems");this.gemsContext=t.getContext("2d");var n=document.getElementById("back");this.bgContext=n.getContext("2d"),this.gemDrawer=new O,t.width=m,t.height=m,n.width=m,n.height=m,this.gemsContext.setTransform(1,0,0,1,0,0),this.bgContext.setTransform(1,0,0,1,0,0)}return Object(a["a"])(e,[{key:"drawAll",value:function(e){var t=this;e.forEach((function(e){t.drawBorders(e),t.clearCell(e),t.drawMapItem(e)}))}},{key:"swap",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t,n){var r,i,a,o,u,s,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:r=t.clone(),i=n.clone(),a=t.clone(),o=n.clone(),u=100,s=x*u/1e3,c=0;case 7:if(!(c<u)){e.next=21;break}return this.clearCell(r),this.clearCell(i),o.shift(f.Right,(r.x-i.x)/s),o.shift(f.Bottom,(r.y-i.y)/s),a.shift(f.Right,(i.x-r.x)/s),a.shift(f.Bottom,(i.y-r.y)/s),this.drawMapItem(o),this.drawMapItem(a),e.next=18,this.wait(k);case 18:c+=k,e.next=7;break;case 21:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t){var n,r,i,a,o=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=150,r=n/k,t.forEach((function(e){return o.fillBg(e)})),i=regeneratorRuntime.mark((function e(n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.forEach((function(e){return o.drawErrosion(e,n/r)})),e.next=3,o.wait(k);case 3:case"end":return e.stop()}}),e)})),a=0;case 5:if(!(a<r)){e.next=10;break}return e.delegateYield(i(a),"t0",7);case 7:a++,e.next=5;break;case 10:case"end":return e.stop()}}),e)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"fall",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=7;break}return t.forEach((function(e){e.fallFrom+=.5;var t=e.clone();t.setY(e.fallFrom),t.y<0||(n.clearCell(t),n.drawMapItem(t))})),t=t.filter((function(e){return e.y>e.fallFrom})),e.next=5,this.wait(k);case 5:e.next=0;break;case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"drawMapItem",value:function(e){var t=this.getAbsolutePosition(e,y);switch(e.value){case d.Red:return this.gemDrawer.drawRed(t,this.gemsContext);case d.Green:return this.gemDrawer.drawGreen(t,this.gemsContext);case d.Blue:return this.gemDrawer.drawBlue(t,this.gemsContext);case d.Purple:return this.gemDrawer.drawPurple(t,this.gemsContext);case d.Yellow:return this.gemDrawer.drawYellow(t,this.gemsContext)}}},{key:"clearCell",value:function(e){var t=1,n=this.getAbsolutePosition(e,-t);this.gemsContext.clearRect(n.x,n.y,p+2*t,p+2*t)}},{key:"drawErrosion",value:function(e,t){var n=(1-t)*b/2,r=this.getAbsolutePosition(e,n),i=p-2*n;this.gemsContext.clearRect(r.x,r.y,i,i)}},{key:"fillBg",value:function(e){this.bgContext.fillStyle=e.bgValue?"#fff":"#eec",this.fillCell(e)}},{key:"drawBorders",value:function(e){this.bgContext.lineWidth=1,this.bgContext.strokeStyle="#aaa";var t=this.getAbsolutePosition(e);this.bgContext.strokeRect(t.x,t.y,p,p)}},{key:"fillCell",value:function(e){var t=1,n=p-2*t,r=this.getAbsolutePosition(e,t);this.bgContext.fillRect(r.x,r.y,n,n)}},{key:"getAbsolutePosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=w+t+p*e.x,r=w+t+p*e.y;return new j(n,r)}},{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}(),B=(n("99af"),n("ac1f"),n("466d"),n("b64b"),function(e){Object(u["a"])(n,e);var t=Object(s["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.value=d.Clear,e.fallFrom=0,e.bgValue=!0,e}return Object(a["a"])(n,[{key:"setRandomValue",value:function(){var e=this.allGems(),t=Math.floor(Math.random()*e.length);this.value=e[t]}},{key:"allGems",value:function(){return Object.keys(d).map((function(e){return+e})).filter((function(e){return!isNaN(e)&&e!==d.Clear})).map((function(e){return e}))}},{key:"clone",value:function(){var e=new n(this.x,this.y);return e.value=this.value,e.bgValue=this.bgValue,e}},{key:"clear",value:function(){this.value=d.Clear}},{key:"toggleBgValue",value:function(){this.bgValue=!1}}]),n}(j)),C=function(){function e(t){Object(o["a"])(this,e),this.items=[],this.size=t}return Object(a["a"])(e,[{key:"getAll",value:function(){return Array.prototype.concat.apply([],this.items)}},{key:"swap",value:function(e,t){var n=this.getItem(e),r=this.getItem(t),i=n.value;n.value=r.value,r.value=i}},{key:"getMatches",value:function(e){var t=this,n=e.map((function(e){return t.getMatchesByPoint(e)}));return Array.prototype.concat.apply([],n)}},{key:"toggleBg",value:function(e){var t=this;e.forEach((function(e){return t.getItem(e).toggleBgValue()}))}},{key:"clear",value:function(e){var t=this;e.forEach((function(e){return t.getItem(e).clear()}))}},{key:"complement",value:function(){for(var e=[],t=0;t<this.size;t++)for(var n=-1,r=0;r<this.size;r++){var i=this.items[t][this.size-r-1];if(i.value===d.Clear){if(i.fallFrom=this.getFallFrom(i,n),i.fallFrom<0)n--,i.setRandomValue();else{var a=this.getItem(new j(t,i.fallFrom));i.value=a.value,a.value=d.Clear}e.push(i)}}return e}},{key:"getFallFrom",value:function(e,t){var n=e.clone();do{n.shift(f.Top)}while(this.isPointInBounds(n)&&this.getItem(n).value===d.Clear);return n.y<0?t:n.y}},{key:"fill",value:function(){this.items=[];for(var e=0;e<this.size;e++){this.items.push([]);for(var t=0;t<this.size;t++)this.items[e].push(new B(e,t))}for(var n=0;n<this.size;n++)for(var r=0;r<this.size;r++){var i=this.items[n][r];do{i.setRandomValue()}while(0!==this.getMatchesByPoint(i).length)}}},{key:"getMatchesByPoint",value:function(e){var t=1,n=this.getMathcesByPointAndDirection(e,f.Left),r=this.getMathcesByPointAndDirection(e,f.Right),i=n.length+r.length>t?n.concat(r):[],a=this.getMathcesByPointAndDirection(e,f.Top),o=this.getMathcesByPointAndDirection(e,f.Bottom),u=a.length+o.length>t?a.concat(o):[],s=i.length+u.length>t?i.concat(u).concat(e):[];return s}},{key:"getMathcesByPointAndDirection",value:function(e,t){var n=[],r=e.clone();while(this.isPointInBounds(r)){if(r.shift(t),!this.match(e,r))break;n.push(r.clone())}return n}},{key:"isPointInBounds",value:function(e){return e.x>=0&&e.y>=0&&e.x<this.size&&e.y<this.size}},{key:"match",value:function(e,t){if(!this.isPointInBounds(e))return!1;if(!this.isPointInBounds(t))return!1;var n=this.getItem(e),r=this.getItem(t);return n.value!==d.Clear&&n.value===r.value}},{key:"getItem",value:function(e){return this.items[e.x][e.y]}}]),e}(),I=function(){function e(){var t=this;Object(o["a"])(this,e),this.lock=!1,this.focused=null,this.matrix=new C(v),this.drawingService=new P,this.matrix.fill(),this.drawingService.drawAll(this.matrix.getAll());var n=document.getElementById("gems");this.boundaries=n.getBoundingClientRect(),n.addEventListener("mousedown",(function(e){return t.pick(new j(e.offsetX,e.offsetY))})),n.addEventListener("touchstart",(function(e){return t.pick(t.getPointFromToches(e))})),n.addEventListener("mousemove",(function(e){return t.move(new j(e.offsetX,e.offsetY))})),n.addEventListener("touchmove",(function(e){return t.move(t.getPointFromToches(e))})),document.addEventListener("mouseup",(function(){return t.cancel()})),document.addEventListener("touchend",(function(){return t.cancel()}))}return Object(a["a"])(e,[{key:"getPointFromToches",value:function(e){var t=e.touches[0],n=t.target,r=(window.innerWidth-n.offsetWidth)/2,i=(window.innerHeight-n.offsetHeight)/2,a=t.pageX-r,o=t.pageY-i;return new j(a,o)}},{key:"pick",value:function(e){this.lock||(this.focused=this.getCoordinates(e),null!==this.focused&&this.drawingService.drawMapItem(this.matrix.getItem(this.focused)))}},{key:"move",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t){var n,r,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!==this.focused){e.next=2;break}return e.abrupt("return");case 2:if(n=this.getCoordinates(t),null!==n){e.next=5;break}return e.abrupt("return");case 5:if(r=this.focused.clone(),i=this.getSecondPoint(r,n),null!==i){e.next=9;break}return e.abrupt("return");case 9:return this.focused=null,this.lock=!0,e.next=13,this.drawingService.swap(this.matrix.getItem(r),this.matrix.getItem(i));case 13:if(this.matrix.swap(this.matrix.getItem(r),this.matrix.getItem(i)),a=this.matrix.getMatches([r,i]),0!==a.length){e.next=21;break}return e.next=18,this.drawingService.swap(this.matrix.getItem(r),this.matrix.getItem(i));case 18:this.matrix.swap(r,i),e.next=23;break;case 21:return e.next=23,this.delete(a);case 23:this.lock=!1;case 24:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=Object(g["a"])(regeneratorRuntime.mark((function e(t){var n,r,i=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=12;break}return n=t.map((function(e){return i.matrix.getItem(e)})),this.matrix.toggleBg(n),e.next=5,this.drawingService.delete(n);case 5:return this.matrix.clear(n),r=this.matrix.complement(),t=this.matrix.getMatches(r),e.next=10,this.drawingService.fall(r);case 10:e.next=0;break;case 12:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSecondPoint",value:function(e,t){var n=t.x-e.x,r=t.y-e.y;if(0===n&&0===r)return null;var i=e.clone(),a=n<0?f.Left:n>0?f.Right:r<0?f.Top:f.Bottom;return i.shift(a),i}},{key:"cancel",value:function(){null!==this.focused&&(this.drawingService.drawMapItem(this.matrix.getItem(this.focused)),this.focused=null)}},{key:"getCoordinates",value:function(e){var t=(e.x-w)*m/this.boundaries.width,n=(e.y-w)*m/this.boundaries.height,r=t/p,i=n/p;return r<0||i<0||r>=v||i>=v?null:new j(Math.floor(r),Math.floor(i))}}]),e}(),R=function(e){Object(u["a"])(n,e);var t=Object(s["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.width=300,e.height=300,e}return Object(a["a"])(n,[{key:"created",value:function(){var e=window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth;this.width=e,this.height=e}},{key:"mounted",value:function(){new I}}]),n}(l["b"]),M=n("6b0d"),S=n.n(M);const A=S()(R,[["render",h]]);var E=A,T=function(e){Object(u["a"])(n,e);var t=Object(s["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(a["a"])(n)}(l["b"]);T=Object(c["a"])([Object(l["a"])({components:{Game:E}})],T);var _=T;n("4ed4");const F=S()(_,[["render",i]]);var D=F,L=n("9483");Object(L["a"])("".concat("/match-three/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),Object(r["b"])(D).mount("#app")}});
//# sourceMappingURL=app.79128e5d.js.map