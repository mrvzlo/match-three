(function(e){function t(t){for(var i,o,s=t[0],u=t[1],c=t[2],h=0,f=[];h<s.length;h++)o=s[h],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&f.push(r[o][0]),r[o]=0;for(i in u)Object.prototype.hasOwnProperty.call(u,i)&&(e[i]=u[i]);l&&l(t);while(f.length)f.shift()();return a.push.apply(a,c||[]),n()}function n(){for(var e,t=0;t<a.length;t++){for(var n=a[t],i=!0,s=1;s<n.length;s++){var u=n[s];0!==r[u]&&(i=!1)}i&&(a.splice(t--,1),e=o(o.s=n[0]))}return e}var i={},r={app:0},a=[];function o(t){if(i[t])return i[t].exports;var n=i[t]={i:t,l:!1,exports:{}};return e[t].call(n.exports,n,n.exports,o),n.l=!0,n.exports}o.m=e,o.c=i,o.d=function(e,t,n){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(o.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)o.d(n,i,function(t){return e[t]}.bind(null,i));return n},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/match-three/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],u=s.push.bind(s);s.push=t,s=s.slice();for(var c=0;c<s.length;c++)t(s[c]);var l=u;a.push([0,"chunk-vendors"]),n()})({0:function(e,t,n){e.exports=n("cd49")},"0755":function(e,t,n){},"4ed4":function(e,t,n){"use strict";n("0755")},cd49:function(e,t,n){"use strict";n.r(t);n("e260"),n("e6cf"),n("cca6"),n("a79d");var i=n("7a23");function r(e,t,n,r,a,o){var s=Object(i["h"])("game");return Object(i["e"])(),Object(i["b"])(s)}var a=n("bee2"),o=n("d4ec"),s=n("262e"),u=n("2caf"),c=n("9ab4"),l=n("ce1f");function h(e,t,n,r,a,o){return Object(i["e"])(),Object(i["c"])("canvas",{id:"map",style:Object(i["d"])({width:e.width+"px",height:e.height+"px"})},null,4)}var f,d,v=n("1da1"),g=(n("96cf"),n("cb29"),n("d81d"),n("d3b7"),n("159b"),n("4de4"),8),y=1e3,m=10,p=10,w=(1e3-2*m)/g,x=w-2*p,b=30,k=1e3/b;(function(e){e[e["Left"]=0]="Left",e[e["Top"]=1]="Top",e[e["Right"]=2]="Right",e[e["Bottom"]=3]="Bottom"})(f||(f={})),function(e){e[e["Clear"]=0]="Clear",e[e["Red"]=1]="Red",e[e["Green"]=2]="Green",e[e["Blue"]=3]="Blue",e[e["Yellow"]=4]="Yellow",e[e["Purple"]=5]="Purple"}(d||(d={}));var O=function(){function e(){Object(o["a"])(this,e)}return Object(a["a"])(e,[{key:"drawRed",value:function(e,t){t.beginPath(),t.fillStyle="#a25b5b",t.moveTo(e.x+4,e.y+5),t.lineTo(e.x+x-4,e.y+5),t.lineTo(e.x+x/2,e.y+x),t.fill()}},{key:"drawGreen",value:function(e,t){t.beginPath(),t.fillStyle="#3c8347";var n=x/4;t.moveTo(e.x+n,e.y),t.lineTo(e.x+x-n,e.y),t.lineTo(e.x+x,e.y+n),t.lineTo(e.x+x,e.y+x-n),t.lineTo(e.x+x-n,e.y+x),t.lineTo(e.x+n,e.y+x),t.lineTo(e.x,e.y+x-n),t.lineTo(e.x,e.y+n),t.fill()}},{key:"drawBlue",value:function(e,t){t.beginPath(),t.fillStyle="#355a9a";var n=x/5;t.moveTo(e.x+x/2,e.y),t.lineTo(e.x+x-10,e.y+n),t.lineTo(e.x+x-10,e.y+x-n),t.lineTo(e.x+x/2,e.y+x),t.lineTo(e.x+10,e.y+x-n),t.lineTo(e.x+10,e.y+n),t.fill()}},{key:"drawPurple",value:function(e,t){t.beginPath(),t.fillStyle="#6e3b7a";var n=x/5;t.moveTo(e.x+x/2,e.y),t.lineTo(e.x+x-5,e.y+n+x/7),t.lineTo(e.x+x-n,e.y+x-3),t.lineTo(e.x+n,e.y+x-3),t.lineTo(e.x+5,e.y+n+x/7),t.fill()}},{key:"drawYellow",value:function(e,t){t.beginPath(),t.fillStyle="#e8cb8e",t.moveTo(e.x+x/2,e.y),t.lineTo(e.x+x,e.y+x/2),t.lineTo(e.x+x/2,e.y+x),t.lineTo(e.x,e.y+x/2),t.fill()}}]),e}(),j=function(){function e(t,n){Object(o["a"])(this,e),this._x=t,this._y=n,this.round()}return Object(a["a"])(e,[{key:"x",get:function(){return this._x}},{key:"y",get:function(){return this._y}},{key:"round",value:function(){this._x=Math.round(this.x),this._y=Math.round(this.y)}},{key:"clone",value:function(){return new e(this.x,this.y)}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;switch(e){case f.Left:return void(this._x-=t);case f.Right:return void(this._x+=t);case f.Top:return void(this._y-=t);case f.Bottom:return void(this._y+=t)}}},{key:"setY",value:function(e){this._y=e}}]),e}(),B=function(){function e(){Object(o["a"])(this,e),this.canvas=document.getElementById("map"),this.context=this.canvas.getContext("2d"),this.gemDrawer=new O,this.canvas.width=y,this.canvas.height=this.canvas.width,this.context.setTransform(1,0,0,1,0,0)}return Object(a["a"])(e,[{key:"drawAll",value:function(e){var t=this;e.forEach((function(e){t.drawCellBg(e),t.drawMapItem(e)}))}},{key:"swap",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t,n){var i,r,a,o,s,u,c;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:i=t.clone(),r=n.clone(),a=t.clone(),o=n.clone(),s=100,u=b*s/1e3,c=0;case 7:if(!(c<s)){e.next=21;break}return this.drawCellBg(i),this.drawCellBg(r),o.shift(f.Right,(i.x-r.x)/u),o.shift(f.Bottom,(i.y-r.y)/u),a.shift(f.Right,(r.x-i.x)/u),a.shift(f.Bottom,(r.y-i.y)/u),this.drawMapItem(o),this.drawMapItem(a),e.next=18,this.wait(k);case 18:c+=k,e.next=7;break;case 21:case"end":return e.stop()}}),e,this)})));function t(t,n){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,a=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:n=200,i=n/k,r=0;case 3:if(!(r<i)){e.next=10;break}return t.forEach((function(e){a.context.fillStyle="rgba(255,255,255,".concat(1/i,")"),a.fillCell(e)})),e.next=7,this.wait(k);case 7:r++,e.next=3;break;case 10:t.forEach((function(e){return a.fillBg(e)}));case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"fall",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=7;break}return t.forEach((function(e){e.fallFrom++;var t=e.clone();t.setY(e.fallFrom),n.fillBg(t),n.drawMapItem(t)})),t=t.filter((function(e){return e.y>e.fallFrom})),e.next=5,this.wait(k);case 5:e.next=0;break;case 7:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"drawMapItem",value:function(e){var t=this.getAbsolutePosition(e,p);switch(this.context.beginPath(),e.value){case d.Red:return this.gemDrawer.drawRed(t,this.context);case d.Green:return this.gemDrawer.drawGreen(t,this.context);case d.Blue:return this.gemDrawer.drawBlue(t,this.context);case d.Purple:return this.gemDrawer.drawPurple(t,this.context);case d.Yellow:return this.gemDrawer.drawYellow(t,this.context)}}},{key:"drawCellBg",value:function(e){this.drawBorders(e),this.fillBg(e)}},{key:"fillBg",value:function(e){this.context.fillStyle="#fff",this.fillCell(e)}},{key:"drawBorders",value:function(e){var t=this.getAbsolutePosition(e);this.context.strokeRect(t.x,t.y,w,w)}},{key:"fillCell",value:function(e){var t=1,n=w-2*t,i=this.getAbsolutePosition(e,t);this.context.fillRect(i.x,i.y,n,n)}},{key:"getAbsolutePosition",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=m+t+w*e.x,i=m+t+w*e.y;return new j(n,i)}},{key:"wait",value:function(e){return new Promise((function(t){return setTimeout(t,e)}))}}]),e}(),P=(n("99af"),n("ac1f"),n("466d"),n("b64b"),function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.value=d.Clear,e.fallFrom=0,e}return Object(a["a"])(n,[{key:"setRandomValue",value:function(){var e=this.allGems(),t=Math.floor(Math.random()*e.length);this.value=e[t]}},{key:"allGems",value:function(){return Object.keys(d).map((function(e){return+e})).filter((function(e){return!isNaN(e)&&e!==d.Clear})).map((function(e){return e}))}},{key:"clone",value:function(){var e=new n(this.x,this.y);return e.value=this.value,e}}]),n}(j)),T=function(){function e(t){Object(o["a"])(this,e),this.items=[],this.size=t}return Object(a["a"])(e,[{key:"getAll",value:function(){return Array.prototype.concat.apply([],this.items)}},{key:"swap",value:function(e,t){var n=this.getItem(e),i=this.getItem(t),r=n.value;n.value=i.value,i.value=r}},{key:"getMatches",value:function(e){var t=this,n=e.map((function(e){return t.getMatchesByPoint(e)}));return Array.prototype.concat.apply([],n)}},{key:"delete",value:function(e){var t=this;e.forEach((function(e){return t.getItem(e).value=d.Clear}))}},{key:"complement",value:function(){for(var e=[],t=0;t<this.size;t++)for(var n=-1,i=0;i<this.size;i++){var r=this.items[t][this.size-i-1];if(r.value===d.Clear){if(r.fallFrom=this.getFallFrom(r,n),r.fallFrom<0)n--,r.setRandomValue();else{var a=this.getItem(new j(t,r.fallFrom));r.value=a.value,a.value=d.Clear}e.push(r)}}return e}},{key:"getFallFrom",value:function(e,t){var n=e.clone();do{n.shift(f.Top)}while(this.isPointInBounds(n)&&this.getItem(n).value===d.Clear);return n.y<0?t:n.y}},{key:"fill",value:function(){this.items=[];for(var e=0;e<this.size;e++){this.items.push([]);for(var t=0;t<this.size;t++)this.items[e].push(new P(e,t))}for(var n=0;n<this.size;n++)for(var i=0;i<this.size;i++){var r=this.items[n][i];do{r.setRandomValue()}while(0!==this.getMatchesByPoint(r).length)}}},{key:"getMatchesByPoint",value:function(e){var t=1,n=this.getMathcesByPointAndDirection(e,f.Left),i=this.getMathcesByPointAndDirection(e,f.Right),r=n.length+i.length>t?n.concat(i):[],a=this.getMathcesByPointAndDirection(e,f.Top),o=this.getMathcesByPointAndDirection(e,f.Bottom),s=a.length+o.length>t?a.concat(o):[],u=r.length+s.length>t?r.concat(s).concat(e):[];return u}},{key:"getMathcesByPointAndDirection",value:function(e,t){var n=[],i=e.clone();while(this.isPointInBounds(i)){if(i.shift(t),!this.match(e,i))break;n.push(i.clone())}return n}},{key:"isPointInBounds",value:function(e){return e.x>=0&&e.y>=0&&e.x<this.size&&e.y<this.size}},{key:"match",value:function(e,t){if(!this.isPointInBounds(e))return!1;if(!this.isPointInBounds(t))return!1;var n=this.getItem(e),i=this.getItem(t);return n.value!==d.Clear&&n.value===i.value}},{key:"getItem",value:function(e){return this.items[e.x][e.y]}}]),e}(),I=function(){function e(){var t=this;Object(o["a"])(this,e),this.lock=!1,this.focused=null,this.matrix=new T(g),this.drawingService=new B,this.matrix.fill(),this.drawingService.drawAll(this.matrix.getAll());var n=document.getElementById("map");this.boundaries=n.getBoundingClientRect(),n.addEventListener("mousedown",(function(e){return t.pick(new j(e.offsetX,e.offsetY))})),n.addEventListener("touchstart",(function(e){var n=e.touches[0],i=n.pageX-n.target.offsetLeft,r=n.pageY-n.target.offsetTop;t.pick(new j(i,r))})),document.addEventListener("mouseup",(function(){return t.cancel()})),document.addEventListener("touchend",(function(){return t.cancel()})),n.addEventListener("mousemove",(function(e){var n=new j(e.offsetX,e.offsetY);t.move(n)})),n.addEventListener("touchmove",(function(e){var n=e.touches[0],i=n.pageX-n.target.offsetLeft,r=n.pageY-n.target.offsetTop;t.move(new j(i,r))}))}return Object(a["a"])(e,[{key:"pick",value:function(e){this.lock||(this.focused=this.getCoordinates(e),null!==this.focused&&this.drawingService.drawMapItem(this.matrix.getItem(this.focused)))}},{key:"move",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n,i,r,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(null!==this.focused){e.next=2;break}return e.abrupt("return");case 2:if(n=this.getCoordinates(t),null!==n){e.next=5;break}return e.abrupt("return");case 5:if(i=this.focused.clone(),r=this.getSecondPoint(i,n),null!==r){e.next=9;break}return e.abrupt("return");case 9:return this.focused=null,this.lock=!0,e.next=13,this.drawingService.swap(this.matrix.getItem(i),this.matrix.getItem(r));case 13:if(this.matrix.swap(this.matrix.getItem(i),this.matrix.getItem(r)),a=this.matrix.getMatches([i,r]),0!==a.length){e.next=21;break}return e.next=18,this.drawingService.swap(this.matrix.getItem(i),this.matrix.getItem(r));case 18:this.matrix.swap(i,r),e.next=23;break;case 21:return e.next=23,this.delete(a);case 23:this.lock=!1;case 24:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"delete",value:function(){var e=Object(v["a"])(regeneratorRuntime.mark((function e(t){var n,i,r=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(!(t.length>0)){e.next=11;break}return n=t.map((function(e){return r.matrix.getItem(e)})),e.next=4,this.drawingService.delete(n);case 4:return this.matrix.delete(t),i=this.matrix.complement(),e.next=8,this.drawingService.fall(i);case 8:t=this.matrix.getMatches(i),e.next=0;break;case 11:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"getSecondPoint",value:function(e,t){var n=t.x-e.x,i=t.y-e.y;if(0===n&&0===i)return null;var r=e.clone(),a=n<0?f.Left:n>0?f.Right:i<0?f.Top:f.Bottom;return r.shift(a),r}},{key:"cancel",value:function(){null!==this.focused&&(this.drawingService.drawMapItem(this.matrix.getItem(this.focused)),this.focused=null)}},{key:"getCoordinates",value:function(e){var t=(e.x-m)*y/this.boundaries.width,n=(e.y-m)*y/this.boundaries.height,i=t/w,r=n/w;return i<0||r<0||i>=g||r>=g?null:new j(Math.floor(i),Math.floor(r))}}]),e}(),M=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){var e;return Object(o["a"])(this,n),e=t.apply(this,arguments),e.width=300,e.height=300,e}return Object(a["a"])(n,[{key:"created",value:function(){var e=window.innerWidth>window.innerHeight?window.innerHeight:window.innerWidth;this.width=e,this.height=e}},{key:"mounted",value:function(){new I}}]),n}(l["b"]),R=n("6b0d"),S=n.n(R);const C=S()(M,[["render",h]]);var A=C,_=function(e){Object(s["a"])(n,e);var t=Object(u["a"])(n);function n(){return Object(o["a"])(this,n),t.apply(this,arguments)}return Object(a["a"])(n)}(l["b"]);_=Object(c["a"])([Object(l["a"])({components:{Game:A}})],_);var E=_;n("4ed4");const F=S()(E,[["render",r]]);var L=F,D=n("9483");Object(D["a"])("".concat("/match-three/","service-worker.js"),{ready:function(){console.log("App is being served from cache by a service worker.\nFor more details, visit https://goo.gl/AFskqB")},registered:function(){console.log("Service worker has been registered.")},cached:function(){console.log("Content has been cached for offline use.")},updatefound:function(){console.log("New content is downloading.")},updated:function(){console.log("New content is available; please refresh.")},offline:function(){console.log("No internet connection found. App is running in offline mode.")},error:function(e){console.error("Error during service worker registration:",e)}}),Object(i["a"])(L).mount("#app")}});
//# sourceMappingURL=app.7b8f0407.js.map